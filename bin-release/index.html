<!DOCTYPE html>
<html>
    <head>
        <title>Aerovale</title>
        <link rel="stylesheet" type="text/css" href="css/aerovale.css" />
    </head>
    <body>
        <h1>Aerovale</h1>
        <p>Após a confirmação do voo, o passageiro deverá se apresentar com 30 minutos de antecedência no local de embarque, com documento oficial de identificação, com foto. Os passageiros que não apresentarem a identificação exigida não poderão embarcar, conforme o Procedimento de Utilização do Aerovale, disponível para consulta no Portal Vale, e as normas da Infraero e ANAC.</p>
        <p>O embarque será feito, impreterivelmente, 10 minutos antes da decolagem. Não será permitido viajar de bermuda, camiseta e/ou chinelos. Por exigência da Infraero, é terminantemente proibido falar ao celular no momento do embarque/desembarque (pista do aeroporto).</p>
        <form method="post" class="frm frmFiltroAeronave" id="frmFiltroAeronave" action="#">
            <div class="frm-grupo cf">
                <label for="origem">Origem</label>
                <div class="frm-controle">
                    <select title="Origem" class="required fakeCombo" name="origem" id="origem">
                        <option value="">Selecione</option>
                        <option value="BHZ">Belo Horizonte</option>
                    </select>
                </div>
            </div>
            <div class="frm-grupo cf">
                <label for="destino">Destino</label>
                <div class="frm-controle">
                    <select title="Destino" class="required fakeCombo" name="destino" id="destino">
                        <option value="">Todos</option>
                        <option value="CKS">Carajás</option>
                    </select>
                </div>
            </div>
            <div class="frm-actions">
                <button type="submit" class="btn">Buscar</button>
            </div>
        </form>
        <div id="flashContentAerovale">
            <p>To view this page ensure that Adobe Flash Player version 11.1.0 or greater is installed.</p>
            <script type="text/javascript"> 
                var pageHost = ((document.location.protocol == "https:") ? "https://" : "http://"); 
                document.write("<a href='http://www.adobe.com/go/getflashplayer'><img src='" + pageHost + "www.adobe.com/images/shared/download_buttons/get_flash_player.gif' alt='Get Adobe Flash player' /></a>" ); 
            </script> 
        </div>
        <h3 id="direcaoAerovale">Selecione um ponto no mapa ou utilize o filtro</h3>
        <div id="resultadoAerovale"></div>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="http://192.168.1.250/tribo/sesc/facebook/circos/web/js/vendor/jquery/jquery-1.9.1.min.js"><\/script>')</script>
        <link rel="stylesheet" type="text/css" href="history/history.css" />
        <script src="history/history.js" type="text/javascript"></script>
        <script src="swfobject.js" type="text/javascript"></script>
        <script type="text/javascript">
            var swfVersionStr = "11.1.0";
            var xiSwfUrlStr = "playerProductInstall.swf";
            var flashvars = {};
            var params = {
                  wmode: "transparent"
                , quality: "high"
                , bgcolor: "#000000"
                , allowscriptaccess: "sameDomain"
                , allowfullscreen: "true"
            };
            var attributes = {
                  id: "aerovale"
                , name: "aerovale"
                , align: "middle"
            };
            swfobject.embedSWF(
                  "Aerovale.swf?noCache=" + new Date().getTime()
                , "flashContentAerovale"
                , "700", "670"
                , swfVersionStr
                , xiSwfUrlStr
                , flashvars
                , params
                , attributes
            );
            swfobject.createCSS("#flashContentAerovale", "display:block;text-align:left;");

            var juninho
                , fulldata
                , cidades = {}
                , combo = {}
                , $destino = $('#destino')
                , $origem = $('#origem')
                ;

            $.getJSON('data/dadosJuninho.js', function(res) {
                $origem.find('option').remove();
                $origem.append('<option value="">Selecione</option>');

                $.each(res.cidades, function(k, v) {
                    cidades[v.sigla] = {
                        "nome": v.nome,
                        "aeroporto": v.aeroporto
                    };
                    $origem.append('<option value="'+v.sigla+'">'+v.nome+'</option>');
                });
                $.each(res.voos, function(k, v) {
                    $.extend(cidades[v.origem], {"destinos": v.destinos});
                });
            });

            $.getJSON('data/dadosFull.js', function(res) {
                console.log(res);
            });

            $origem.on('change', {"destino": $destino}, function(ev) {
                ev.data.destino.find('option').remove();
                ev.data.destino.append('<option value="">Todos</option>');
                $.each(cidades[this.value].destinos, function(k, v) {
                    ev.data.destino.append('<option value="'+v+'">'+cidades[v].nome+'</option>');
                });
            });

            window.onload = (function(){
                return function(){
                    $('#frmFiltroAeronave')
                    .on('submit', function(ev) {
                        ev.preventDefault();
                        var o = $('#origem').val();
                        var d = $('#destino').val();
                        if(o)
                        {
                            var obj = swfobject.getObjectById("aerovale");
                            if (obj)
                                d = d || null;
                                obj.origemDestino(o, d);
                        }
                    });
                }
            })();

            function destinosDe(origem)
            {
                console.log(origem);
            }
        </script>
   </body>
</html>
